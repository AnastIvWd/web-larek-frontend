# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Базовый класс
Класс `EventEmitter`

Позволяет: добавлять, удалять, инициировать события, а также добавлять обработчики для всех событий и сбрасывать все обработчики. Класс также предоставляет следующие методы: 1. `on` - устанавливает обработчик на события; 2. `off` - снимает обработчик с события; 3. `emit` - вызывает событие; 4. `onAll` - слушает все события; 5. `offAll` - сбрасывает все обработчики; 6. `trigger` - делает коллбек триггер, генерирующий событие при вызове.

## Описание данных
``` TS
//Каталог
interface IProductList {
  total: number; // Количество карточек товаров
  items: IProductItem[]; // Массив товаров
}

//Товар
interface IProductItem {
  id: string; // идентификатор товара
  description: string; // описание товара
  image: string; // изображение товара
  title: string; // наименование товара
  category: string; // категория товара
  price: number // цена товара
}

//Ошибка
interface IErrorResponse {
  error: string; // текст ошибки
}

//Заказ
interface IOrder {
  payment: string; // способ оплаты заказа
  email: string; // почта пользователя
  phone: string; // телефон пользователя
  address: string; // адрес пользователя
  total: number; // итоговая сумма заказа
  items: IProductItem['id'][]; // массив товаров в корзине
}

//Ответ успешного создания заказа
interface IOrderSuccessResponse {
  id: string; // идентификатор заказа
  total: number; // итоговая сумма заказа
}

//все события на веб-странице
enum EventNamesEnum {
 OPEN_PRODUCT_MODAL = "OPEN_PRODUCT_MODAL", // открытие модального окна "Карточка товара"
  CLOSE_PRODUCT_MODAL = "CLOSE_PRODUCT_MODAL", // закрытие модального окна "Карточка товара"
  ADD_PRODUCT_IN_CART = "ADD_PRODUCT_IN_CART", // добавление товара в корзину
  DELETE_PRODUCT_FROM_CART = "DELETE_PRODUCT_FROM_CART", // удаление товара из корзины
  OPEN_CART = "OPEN_CART", // открытие модального окна "Корзина"
  CLOSE_CART = "CLOSE_CART", // закрытие модального окна "Корзина"
  SUBMIT_CART = "SUBMIT_CART", // переход к формам для оформления заказа - переход к 1 части формы
  CLICK_NEXT = "CLICK_NEXT", // следующий шаг оформления заказа - переход ко 2 части формы
  SUBMIT_ORDER = "SUBMIT_ORDER", // оформление заказа после заполнения форм + очистка массива товаров в корзине
  CLOSE_ORDER = "CLOSE_ORDER" // закрытие модального окна "Заказ"
}
```

## Компоненты 
### 1. Класс `CatalogModel`
```ts
interface ICatalogModel {
  api: Api; // наследник класса API, через который осуществляется запрос внутри класса для получения карточек товаров
  products: IProductList; // массив карточек товаров и их количество
  setProductList(): Promise<void>; // метод, который асинхронно получает данные и устанавливает их в объекте
  getProductList(): IProductList; // метод, возвращающий текущий список товаров и их количество
}
```
- Класс определяет структуру объекта для управления каталогом товаров, включающую API для запросов, массив товаров с их количеством, а также методы для асинхронного получения и возврата списка товаров.

### 2. Класс `CatalogView`
```ts
interface ICatalogView {
  catalogPlace: HTMLElement; // элемент, в котором будут отрисовываться карточки товаров
  catalogElement: HTMLElement; // карточка товара
  renderCatalog(catalog: IProductList): void; // метод, который отображает товары в элементе DOM
}
```
- Класс включает в себя элементы DOM для размещения и отображения товаров и управляет отображением товаров на веб-странице методом `renderCatalog`. Также при отрисовке элементов сгенерируются 2 события: 1. `OPEN_CART` - открытие модального окна "Корзина"; 2. `OPEN_PRODUCT_MODAL` - открытие модального окна "Карточка товара". 

### 3. Класс `ProductModel`
```ts
interface IProductModel {
  api: Api; // наследник класса API, через который осуществляется запрос внутри класса для получения данных о товаре
  product: IProductItem; // данные о товаре
  setProductItem(): Promise<void>; // метод, который асинхронно получает данные и устанавливает их в объекте
  getProductItem(): IProductItem; // метод, возвращающий данные о товаре 
}
```
- Класс определяет структуру объекта для управления данными о товаре, включая API для получения данных с сервера, хранение информации о товаре, а также методы для асинхронного получения и возврата данных о товаре.

### 4. Класс `ProductView`
```ts
interface IProductView {
  productPlace: HTMLElement; // элемент, в котором будет отрисовываться карточка товара
  productElement: HTMLElement; // элемент карточки товара
  renderProduct(product: IProductItem): void; // метод, который отображает элементы в карточке товара
}
```
- Класс включает в себя элементы DOM для размещения и отображения элементов карточки товара и управляет отображением этих элементов в модальном окне "Карточка товара" методом `renderProduct`. Также при отрисовке элементов сгенерируются 2 события: 1. `ADD_PRODUCT_IN_CART` - добавление товара в массив корзины; 2. `CLOSE_PRODUCT_MODAL` - закрытие модального окна "Карточка товара".

### 5. Класс `CartModel`
```ts
interface ICartModel {
  items: IProductItem[]; // собранный массив товаров в корзине
  addProduct(productId: string): void // метод, добавляющий товар в корзину
  removeProduct(productId: string): void // метод, убирающий товар из корзины
  resetCart(): void // метод, очищающий корзину при успешном оформлении заказа
}
```
- Данный класс позволяет изменять массив товаров: добавлять или удалять товар из массива, а также делать массив пустым при успешном оформлении заказа.

### 6. Класс `CartView`
```ts
interface ICartView {
  cartPlace: HTMLElement; // элемент, в котором будет отрисовываться элементы карточек товаров + элементы корзины
  cartElement: HTMLElement; // элементы карточки товара + элементы корзины
  renderCart(products: IProductItem[]): void; // метод, который отображает элементы в корзине
}
```
- Класс включает в себя элементы DOM для размещения и отображения списка товаров и управляет их отображением в модальном окне "Корзина" методом `renderCart`. Также при отрисовке элементов сгенерируются 3 события: 1. `DELETE_PRODUCT_FROM_CART` - удаление товара из массива корзины, 2. `CLOSE_CART` - закрытие модального окна "Корзина", 3. `SUBMIT_CART` - переход к модальному окну "Заказ" (формы). 

### 7. Класс `OrderModel`
```ts
interface IOrderModel {
  api: Api; // наследник класса API, через который осуществляется запрос внутри класса для обработки данных заказа
  order: IOrder; //данные о заказе
  submitOrder(): Promise<void>; // метод, который асинхронно отправляет заказ
  updateInfoOrder(order: IOrder): void; // обновление информации в заказе
}
```
- Класс определяет структуру объекта для управления данными заказа, включая API для взаимодействия с сервером, хранение данных о заказе, а также методы для асинхронной отправки заказа - `submitOrder`и обновления его информации - `updateInfoOrder`.

### 8. Класс `OrderView`
```ts
interface IOrderView {
  orderPlace: HTMLElement; // элемент, в котором будет отрисовываться формы для оформления заказа
  orderElement: HTMLElement; // формы и элементы модального окна "Заказ"
  renderOrder(): void; // метод, который отображает формы в модальном окне "Заказ"
  renderOrderStatus(total: IOrder['total']): void; // метод, отоброжающий статус и итоговую сумму заказа
}
```
- Класс включает в себя элементы DOM для размещения и отображения форм для ввода данных о покупателе и управляет их отображением в модальном окне "Заказ" методом `renderOrder`. Также при отрисовке элементов сгенерируются 3 события: 1. `CLICK_NEXT` - следующий шаг оформления заказа - переход ко 2 части формы; 2. `SUBMIT_ORDER` -  оформление заказа после заполнения форм + очистка массива товаров в корзине; 3. `CLOSE_ORDER` - закрытие модального окна "Заказ". 
- Также после `SUBMIT_ORDER` - появлеется модальное окно "Статус" - которое отрисовывет метод `renderOrderStatus`. В данном модалном оке генерируется 1 событие:  `CLOSE_ORDER` - закрытие модального окна "Статус".